# 1C_client_update

Делает:

-Обновляет 1С клиента в соответствии с версией сервера централизованно

Функциональное описание: 

-Создает файл лога скрипта, если он не создан

-Собирает массив имен клиентских ПК windows из AD, далее делает для каждого из участников массива

-Копирует установочные файлы 1С на диск С:

-Ищет установленные программы, название которых начинается с 1С

-Если находит - сверяет версию с текущей версией сервера

-Если версия различается - пишет в лог, удаляет текущую версию, устанавливает актуальную версию в зависимости от разрядности ОС (если установочный файл доступен)

-Если версия не различается - удаляет установочные файлы и переходит к следующему ПК

-Если выполнение шагов выше занимает больше 10 минут - отменяет задание и удаляет установочные файлы, потом переходит к следующему ПК

Требования к внедрению:

-Powersheel минимально версии 3

-Powersheel ExecutionPolicy Unrestricted

-Запуск с повышенными привилегиями

-Доступ к $Repo, setup.exe, серверу 1С

-Минимум 500 МБ свободного места на диске C:

-Путь к файлу установки должны быть вида $Repo+"*-64\setup.exe или $Repo+"*-32\setup.exe, где * любое допустимое множество символов
